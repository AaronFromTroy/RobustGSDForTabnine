---
phase: 02-core-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - gsd/package.json
  - gsd/scripts/.gitkeep
autonomous: true

must_haves:
  truths:
    - "Dependencies are installed and available for import"
    - "Scripts directory exists and is ready for modules"
    - "package.json declares ESM module type"
  artifacts:
    - path: "gsd/package.json"
      provides: "Project metadata and dependency declarations"
      contains: "\"type\": \"module\""
      min_lines: 15
    - path: "gsd/scripts/.gitkeep"
      provides: "Scripts directory structure"
      min_lines: 1
  key_links:
    - from: "package.json"
      to: "npm registry"
      via: "npm install"
      pattern: "write-file-atomic|ajv|front-matter"
---

<objective>
Establish the Node.js project foundation with ESM module support and required dependencies for atomic file operations, JSON Schema validation, and YAML frontmatter parsing.

Purpose: Enable Phase 2 script development by declaring the runtime environment (Node 24 LTS, ESM) and installing libraries identified in RESEARCH.md (write-file-atomic, ajv, front-matter).

Output: Functional package.json with dependencies installed, scripts directory ready for module files.
</objective>

<execution_context>
@C:\Projects\GSDForTabnine\.planning\phases\02-core-infrastructure\02-RESEARCH.md
@C:\Projects\GSDForTabnine\gsd\.gsd-config.json
</execution_context>

<context>
@C:\Projects\GSDForTabnine\.planning\PROJECT.md
@C:\Projects\GSDForTabnine\.planning\ROADMAP.md
@C:\Projects\GSDForTabnine\.planning\STATE.md
@C:\Projects\GSDForTabnine\.planning\REQUIREMENTS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create package.json with ESM and dependencies</name>
  <files>gsd/package.json</files>
  <action>
Create package.json in gsd/ directory with the following configuration:

**Required fields:**
- name: "gsd-for-tabnine"
- version: "1.0.0"
- description: "GSD workflow system for Tabnine agent mode"
- type: "module" (CRITICAL: enables ESM imports)
- engines: { "node": ">=24.0.0" } (Node 24 LTS requirement)

**Dependencies (from RESEARCH.md):**
- write-file-atomic: "^5.0.1" (atomic STATE.md writes)
- ajv: "^8.12.0" (JSON Schema validation, 50% faster than alternatives)
- front-matter: "^4.0.2" (YAML frontmatter parsing for templates)

**Scripts:**
- "test": "echo \"Tests in Phase 3\" && exit 0"

**Metadata:**
- private: true (not publishing to npm)
- author, license fields (author: "GSD Project", license: "MIT")

Use exact versions from RESEARCH.md to ensure compatibility. Do NOT use semantic versioning ranges (^) if exact versions specified in research.
  </action>
  <verify>
```bash
cd C:/Projects/GSDForTabnine/gsd && cat package.json
node -e "console.log(JSON.parse(require('fs').readFileSync('gsd/package.json')).type === 'module' ? 'ESM enabled' : 'ERROR: CommonJS')"
```

Expected: package.json exists, contains "type": "module", lists all three dependencies.
  </verify>
  <done>package.json exists with type: "module", all dependencies declared, valid JSON structure</done>
</task>

<task type="auto">
  <name>Task 2: Install dependencies and create scripts directory</name>
  <files>gsd/scripts/.gitkeep</files>
  <action>
**Install npm dependencies:**

Run npm install in gsd/ directory to download and install:
- write-file-atomic (atomic file writes for STATE.md)
- ajv (JSON Schema validation for config)
- front-matter (parse YAML frontmatter from templates)

**Create scripts directory structure:**

Create gsd/scripts/ directory with .gitkeep placeholder file. This directory will hold all Node.js modules in subsequent plans:
- state-manager.js (Plan 02-03)
- template-renderer.js (Plan 02-04)
- guideline-loader.js (Plan 02-04)
- file-ops.js (Plan 02-02)
- process-runner.js (Plan 02-02)

**Verify installation:**

After npm install completes, verify node_modules/ contains write-file-atomic, ajv, and front-matter directories.

Use cross-platform path handling: `path.join('gsd', 'scripts')` not hardcoded separators.
  </action>
  <verify>
```bash
cd C:/Projects/GSDForTabnine/gsd && npm install
ls gsd/node_modules/write-file-atomic gsd/node_modules/ajv gsd/node_modules/front-matter
ls gsd/scripts/.gitkeep
```

Expected: All three packages installed in node_modules/, scripts/ directory exists with .gitkeep file.
  </verify>
  <done>Dependencies installed successfully, scripts/ directory exists and is ready for module files</done>
</task>

</tasks>

<verification>
1. package.json parses as valid JSON
2. package.json contains "type": "module" field
3. All three dependencies (write-file-atomic, ajv, front-matter) installed in node_modules/
4. gsd/scripts/ directory exists
5. No errors during npm install
</verification>

<success_criteria>
- package.json exists with ESM enabled ("type": "module")
- write-file-atomic, ajv, front-matter installed and importable
- scripts/ directory ready for Phase 2 module development
- No build step required (templates and guidelines already exist from Phase 1)
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-infrastructure/02-01-SUMMARY.md` documenting:
- package.json structure and dependency versions installed
- npm install output (success/warnings)
- scripts/ directory created
- Requirements fulfilled: SCRIPT-05 (ESM modules), partial CORE-03 (dependencies for templates)
</output>
