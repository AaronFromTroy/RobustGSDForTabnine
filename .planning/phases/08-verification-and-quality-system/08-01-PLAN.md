---
phase: 08-verification-and-quality-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - gsd/templates/VERIFICATION.md
  - gsd/scripts/goal-validator.js
autonomous: true

must_haves:
  truths:
    - "VERIFICATION.md template exists and can be rendered with issue data"
    - "Goal validator can extract success criteria from ROADMAP.md"
    - "Goal validator can validate acceptance criteria programmatically"
    - "Each validation failure includes remediation guidance"
  artifacts:
    - path: "gsd/templates/VERIFICATION.md"
      provides: "Verification report template with YAML frontmatter"
      min_lines: 50
    - path: "gsd/scripts/goal-validator.js"
      provides: "Acceptance criteria validation logic"
      exports: ["validateAcceptanceCriteria", "extractSuccessCriteria", "createValidator"]
  key_links:
    - from: "gsd/scripts/goal-validator.js"
      to: "ROADMAP.md"
      via: "extractSuccessCriteria regex parsing"
      pattern: "readFile.*ROADMAP\\.md"
    - from: "gsd/templates/VERIFICATION.md"
      to: "gsd/scripts/template-renderer.js"
      via: "renderTemplate function"
      pattern: "\\$\\{\\w+\\}"
---

<objective>
Create VERIFICATION.md template and goal-backward acceptance criteria validation.

Purpose: Enable automated verification that built features achieve their intended goals, not just technical correctness. This completes the missing piece referenced in verify-work.md guideline (line 28) where VERIFICATION.md template is used but doesn't exist yet.

Output: VERIFICATION.md template compatible with template-renderer.js, and goal-validator.js module that validates phase success criteria from ROADMAP.md using ATDD (Acceptance Test-Driven Development) pattern.
</objective>

<execution_context>
@C:/Users/acous/OneDrive/Documents/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/acous/OneDrive/Documents/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@C:/Projects/GSDForTabnine/.planning/PROJECT.md
@C:/Projects/GSDForTabnine/.planning/ROADMAP.md
@C:/Projects/GSDForTabnine/.planning/STATE.md
@C:/Projects/GSDForTabnine/.planning/phases/08-verification-and-quality-system/08-RESEARCH.md
@C:/Projects/GSDForTabnine/gsd/guidelines/verify-work.md
@C:/Projects/GSDForTabnine/gsd/scripts/validator.js
@C:/Projects/GSDForTabnine/gsd/templates/SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VERIFICATION.md template</name>
  <files>gsd/templates/VERIFICATION.md</files>
  <action>
    Create VERIFICATION.md template following existing template patterns (SUMMARY.md, CONTEXT.md).

    Structure (80-100 lines):
    - YAML frontmatter: phase, verified, timestamp, passed, failures_count, layers (smoke/lint/unit/integration/acceptance)
    - Executive summary section with pass/fail, duration, phase info
    - Verification layers section with results for each layer (smoke → static → unit → integration → acceptance)
    - Failed criteria section (only if failures exist) with issue/remediation/priority
    - Quality metrics section: coverage (lines/branches/functions), complexity (avg/max), tests (total/passed/failed)
    - Next action section (proceed if passed, fix issues if failed)

    Use template literal syntax: ${phase}, ${passed}, ${timestamp}, ${failures}, ${layers_smoke_passed}, ${coverage_lines}, etc.

    Follow template-renderer.js compatibility: Function constructor evaluates ${var} syntax.

    Reference existing templates for style:
    - SUMMARY.md: Frontmatter structure and section layout
    - CONTEXT.md: Conditional sections (deferred section only if has content)
  </action>
  <verify>
    1. Template has valid YAML frontmatter (phase, verified, timestamp, passed, failures_count)
    2. Template uses ${variable} syntax throughout (no hardcoded values)
    3. Template has all required sections (summary, layers, failures, metrics, next_action)
    4. File is valid markdown (can be parsed by markdown processors)
    5. Template is 80-100 lines (comprehensive but not bloated)
  </verify>
  <done>
    VERIFICATION.md template exists in gsd/templates/ and can be rendered by template-renderer.js with verification data variables. Template includes all sections needed by verify-work.md guideline (line 28 references this template).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create goal-validator.js module</name>
  <files>gsd/scripts/goal-validator.js</files>
  <action>
    Create goal-validator.js module implementing ATDD pattern from research (08-RESEARCH.md lines 108-148, 472-569).

    Exports (3 functions, 250-300 lines total):

    1. validateAcceptanceCriteria(phaseNumber):
       - Reads ROADMAP.md and extracts success criteria for phase
       - For each criterion: creates validator, executes validation, records pass/fail with remediation
       - Returns array of { criterion, passed, remediation }
       - Pattern from research: Given-When-Then format (even if ROADMAP doesn't use it explicitly)

    2. extractSuccessCriteria(roadmap, phaseNumber):
       - Parses ROADMAP.md for phase section (### Phase N:)
       - Finds "Success Criteria:" subsection
       - Extracts numbered list items (1. ..., 2. ..., etc.)
       - Returns array of { text, remediation } objects
       - Uses regex pattern: /^\d+\.\s+(.+)$/gm for numbered lists

    3. createValidator(criterion):
       - Converts criterion text to validation function (async)
       - Detects criterion type from keywords:
         * "artifacts" → check file existence (PROJECT.md, ROADMAP.md, etc.)
         * "tests" → run integration-test.js, check exit code
         * "coverage" → parse coverage from test output, check threshold
         * "requirements" → validate requirement traceability (use validator.js)
         * "STATE.md" → check STATE.md shows phase completion
       - Returns async function that returns boolean (passed/failed)
       - Default: return true (assume passes if no specific validator)

    Import patterns:
    - readFile from './file-ops.js'
    - fileExists from './file-ops.js'
    - runCommand from './process-runner.js'
    - path from 'node:path'

    Validation heuristics (smart detection):
    - "All required artifacts exist" → check .planning/ directory for PROJECT.md, ROADMAP.md, REQUIREMENTS.md
    - "tests pass" or "integration tests" → runCommand('node', ['gsd/scripts/integration-test.js']), check exitCode === 0
    - "coverage" → parse test output for coverage percentage, check >= 80%
    - "Developer can copy gsd/ directory" → check gsd/README.md exists
    - "STATE.md shows" → readFile STATE.md, check for phase number and status

    Error handling:
    - Graceful failures: if validator throws error, catch and return false (don't crash entire validation)
    - Informative remediation: generateRemediation function creates actionable steps based on criterion type

    Follow existing module patterns (validator.js, researcher.js):
    - JSDoc comments for all exported functions
    - Helper functions for parsing and validation logic
    - Explicit error messages with context
  </action>
  <verify>
    1. Module exports 3 functions: validateAcceptanceCriteria, extractSuccessCriteria, createValidator
    2. validateAcceptanceCriteria returns array of validation results with criterion/passed/remediation
    3. extractSuccessCriteria extracts numbered list items from ROADMAP.md success criteria section
    4. createValidator detects criterion type and returns appropriate async validator function
    5. Code follows ESM syntax (import/export, not require)
    6. All functions have JSDoc comments
    7. No syntax errors (can be imported without throwing)
  </verify>
  <done>
    goal-validator.js module exists and implements ATDD pattern for validating phase success criteria. Module can extract criteria from ROADMAP.md, create type-specific validators, and return pass/fail results with remediation guidance. Complements existing validator.js (artifact structure) by adding goal-backward validation layer.
  </done>
</task>

</tasks>

<verification>
Run these checks after task completion:

1. VERIFICATION.md template rendering:
   ```bash
   node gsd/scripts/template-renderer.js --test-template=VERIFICATION --variables='{"phase":"08","passed":false,"failures_count":2}'
   ```
   Expected: Template renders without errors, ${variables} replaced correctly

2. Goal validator module import:
   ```bash
   node -e "import('./gsd/scripts/goal-validator.js').then(m => console.log('Exports:', Object.keys(m)))"
   ```
   Expected: Exports: validateAcceptanceCriteria, extractSuccessCriteria, createValidator

3. Extract criteria from ROADMAP:
   ```bash
   node -e "import('./gsd/scripts/goal-validator.js').then(async m => { const roadmap = await import('fs').then(fs => fs.promises.readFile('.planning/ROADMAP.md', 'utf-8')); const criteria = m.extractSuccessCriteria(roadmap, 1); console.log('Phase 1 criteria:', criteria.length); })"
   ```
   Expected: Outputs Phase 1 criteria count (should be 5 per ROADMAP.md)

4. Validate acceptance criteria:
   ```bash
   node -e "import('./gsd/scripts/goal-validator.js').then(async m => { const results = await m.validateAcceptanceCriteria(1); console.log('Validation results:', results.map(r => r.passed)); })"
   ```
   Expected: Array of true/false for each Phase 1 success criterion
</verification>

<success_criteria>
1. VERIFICATION.md template exists with valid frontmatter and all required sections
2. Template uses ${variable} syntax and is compatible with template-renderer.js
3. goal-validator.js exports 3 functions for acceptance criteria validation
4. extractSuccessCriteria can parse ROADMAP.md and extract numbered success criteria
5. createValidator detects criterion types and creates appropriate validators
6. validateAcceptanceCriteria returns structured results with remediation guidance
7. Module follows ESM syntax and existing GSD patterns (error handling, JSDoc)
8. No import/syntax errors (can be imported and used immediately)
</success_criteria>

<output>
After completion, create `.planning/phases/08-verification-and-quality-system/08-01-SUMMARY.md`
</output>
